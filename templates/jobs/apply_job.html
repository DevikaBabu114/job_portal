{% extends 'base.html' %}

{% block title %}Apply for {{ job.title }} | JobPortal{% endblock %}

{% block content %}
<div class="container" style="max-width: 800px; margin: 0 auto; padding: 20px;">
    <a href="{% url 'job_detail' job.id %}" style="color: #007bff; text-decoration: none; margin-bottom: 20px; display: inline-block;">
        ‚Üê Back to Job Details
    </a>
    
    <div style="border: 1px solid #ddd; padding: 30px; border-radius: 10px; background: white;">
        <h1 style="margin: 0 0 10px 0; color: #333;">Apply for Position</h1>
        <h3 style="color: #007bff; margin: 0 0 30px 0;">{{ job.title }} at {{ job.employer.company_name }}</h3>
        
        <!-- Job Summary -->
        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
            <h4 style="margin: 0 0 15px 0;">Job Summary</h4>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                <div>
                    <strong>Location:</strong><br>
                    {{ job.location }}
                </div>
                <div>
                    <strong>Job Type:</strong><br>
                    {{ job.get_job_type_display }}
                </div>
                <div>
                    <strong>Experience:</strong><br>
                    {{ job.get_experience_level_display }}
                </div>
                {% if job.salary %}
                <div>
                    <strong>Salary:</strong><br>
                    {{ job.salary }}
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Application Form -->
        <form method="POST">
            {% csrf_token %}
            
            <!-- Applicant Info -->
            <div style="margin-bottom: 30px;">
                <h4 style="margin-bottom: 15px;">Your Information</h4>
                <div style="background: #f0f8ff; padding: 20px; border-radius: 8px;">
                    <p><strong>Name:</strong> {{ user.jobseeker.full_name }}</p>
                    <p><strong>Email:</strong> {{ user.email }}</p>
                    <p><strong>Phone:</strong> {{ user.jobseeker.phone }}</p>
                    <p><strong>Location:</strong> {{ user.jobseeker.location|default:"Not specified" }}</p>
                    {% if user.jobseeker.resume %}
                    <p><strong>Resume:</strong> 
                        <a href="{{ user.jobseeker.resume.url }}" target="_blank" style="color: #007bff;">
                            View Current Resume
                        </a>
                    </p>
                    {% else %}
                    <p style="color: #dc3545;"><strong>Resume:</strong> No resume uploaded</p>
                    {% endif %}
                </div>
            </div>

            <!-- Cover Letter -->
            <div style="margin-bottom: 30px;">
                <h4 style="margin-bottom: 15px;">Cover Letter</h4>
                <p style="color: #666; margin-bottom: 15px;">
                    Tell the employer why you're a good fit for this position. Highlight your relevant skills and experience.
                </p>
                <textarea 
                    name="cover_letter" 
                    rows="8" 
                    placeholder="Write your cover letter here... Explain why you're interested in this position and how your skills match the job requirements."
                    style="width: 100%; padding: 15px; border: 1px solid #ddd; border-radius: 8px; font-family: inherit; resize: vertical;"
                    required
                ></textarea>
            </div>

            <!-- Skills Match -->
            {% if user.jobseeker.skills %}
            <div style="margin-bottom: 30px;">
                <h4 style="margin-bottom: 15px;">Your Skills</h4>
                <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 15px;">
                    {% for skill in user.jobseeker.skills_list %}
                        <span style="background: #e9ecef; padding: 5px 12px; border-radius: 15px; font-size: 0.9rem;">
                            {{ skill }}
                        </span>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Application Tips -->
            <div style="background: #fff3cd; padding: 20px; border-radius: 8px; margin-bottom: 30px; border-left: 4px solid #ffc107;">
                <h5 style="margin: 0 0 10px 0; color: #856404;">
                    <i class="fas fa-lightbulb"></i> Application Tips
                </h5>
                <ul style="margin: 0; color: #856404; padding-left: 20px;">
                    <li>Customize your cover letter for this specific job</li>
                    <li>Highlight how your skills match the job requirements</li>
                    <li>Keep your cover letter professional and concise</li>
                    <li>Proofread for spelling and grammar errors</li>
                </ul>
            </div>

            <!-- Submit Buttons -->
            <div style="display: flex; gap: 15px; justify-content: flex-end;">
                <a href="{% url 'job_detail' job.id %}" 
                   style="padding: 12px 24px; border: 1px solid #007bff; color: #007bff; text-decoration: none; border-radius: 5px;">
                    Cancel
                </a>
                <button type="submit" 
                        style="padding: 12px 24px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                    <i class="fas fa-paper-plane"></i> Submit Application
                </button>
            </div>
        </form>
    </div>
</div>

<style>
.container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
}

@media (max-width: 768px) {
    .container {
        padding: 15px;
    }
    
    div[style*="grid-template-columns"] {
        grid-template-columns: 1fr !important;
    }
    
    div[style*="flex; justify-content"] {
        flex-direction: column;
    }
}
</style>
{% endblock %}